"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const debug_1 = require("debug");
const fs = require("fs");
const path = require("path");
const create_report_1 = require("./create-report");
const options_1 = require("./options");
const debugLog = debug_1.default("unmock-jest:writer");
exports.writeToDirectory = (contents, options) => {
    const filepath = path.join(options.outputDirectory, options.outputFilename);
    const absoluteFilePath = path.isAbsolute(filepath)
        ? filepath
        : path.resolve(process.cwd(), filepath);
    const dirname = path.dirname(absoluteFilePath);
    if (!fs.existsSync(dirname)) {
        debugLog(`Creating directory: ${dirname}`);
        try {
            fs.mkdirSync(dirname);
        }
        catch (err) {
            throw Error(`Failed creating directory: ${dirname}`);
        }
    }
    debugLog(`Writing to: ${absoluteFilePath}`);
    fs.writeFileSync(absoluteFilePath, contents);
    return absoluteFilePath;
};
const writeReport = (input, opts) => {
    const options = options_1.resolveOptions(opts || {});
    const report = create_report_1.default(input);
    return exports.writeToDirectory(report, options);
};
exports.default = writeReport;
//# sourceMappingURL=write-report.js.map