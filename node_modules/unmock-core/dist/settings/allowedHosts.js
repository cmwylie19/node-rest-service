"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const utils_1 = require("./utils");
class AllowedHosts {
    constructor(whitelist = [
        "127.0.0.1",
        "127.0.0.0",
        "localhost",
    ], regexWhitelist = utils_1.whitelistToRegex(whitelist)) {
        this.whitelist = whitelist;
        this.regexWhitelist = regexWhitelist;
    }
    set(urls) {
        this.whitelist = Array.isArray(urls) ? urls : [urls];
        this.regexWhitelist = utils_1.whitelistToRegex(this.whitelist);
    }
    add(urls) {
        Array.isArray(urls)
            ? this.whitelist.push(...urls)
            : this.whitelist.push(urls);
        this.regexWhitelist = utils_1.whitelistToRegex(this.whitelist);
    }
    get() {
        return this.whitelist.map((url) => url instanceof RegExp ? url.source : url);
    }
    isWhitelisted(host) {
        return this.regexWhitelist.filter(wl => wl.test(host)).length > 0;
    }
}
exports.AllowedHosts = AllowedHosts;
//# sourceMappingURL=allowedHosts.js.map